[{"path":"https://aberhrml.github.io/assignments/articles/assignments.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"assignments","text":"assignments package provides automated molecular formula assignment approach ultra-high resolution electrospray ionisation mass spectrometry (ESI-MS) data metabolomics experiments. includes data direct flow injection/infusion fingerprinting well liquid chromatograph mass spectrometry (LC-MS) profiling analytical techniques. vignette provide brief overview input data required, parameter selection, performing assignments assessing results. begin, first load package.","code":"library(assignments)"},{"path":"https://aberhrml.github.io/assignments/articles/assignments.html","id":"computational-requirements-and-parallel-processing","dir":"Articles","previous_headings":"","what":"Computational requirements and parallel processing","title":"assignments","text":"approach computationally intensive use high-performance computing resources recommended. suggested minimum use 16 CPU workers least 8GB RAM per worker (128GB total) ensure processing completed reasonable duration. parallel back-end provided future package. Information available parallel strategies can found . example use relatively tiny data set following example parallel options used:","code":"plan('multisession',workers = 2)"},{"path":"https://aberhrml.github.io/assignments/articles/assignments.html","id":"input-data","dir":"Articles","previous_headings":"","what":"Input data","title":"assignments","text":"requirements data input designed simple possible. Input data consist m/z sample intensity matrix positive negative mode data combined available. m/z features provided column names form <ionisation_mode><m/z>@<retention_time>. Ionisation mode given prefix n p negative positive ionisation modes respectively. Feature m/z provided accuracy least 5 decimal places. retention time portion (@<retention_time>) required LC-MS data provided minutes. recommended data undergo pre-treatment routines relative standard deviation filtering, imputation /normalisation prior assignment. However, essential requirement raw intensity values also used. input data example subset FIE-HRMS metabolomics experiment shown . feature intensities total ion count (TIC) normalised.","code":"feature_data #> # A tibble: 60 × 10 #>    n191.01962 n192.02306 n193.…¹ n226.…² n228.…³ n228.…⁴ n231.…⁵ n384.…⁶ n385.…⁷ #>         <dbl>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1     0.109     0.00401 6.09e-4 4.17e-4 1.35e-3 9.12e-5 1.22e-3 3.11e-4 3.10e-5 #>  2     0.0955    0.00346 4.66e-4 3.06e-4 1.10e-3 8.47e-5 8.31e-4 1.00e-4 8.88e-7 #>  3     0.109     0.00418 6.37e-4 2.94e-4 1.13e-3 8.79e-5 1.26e-3 3.64e-4 8.01e-5 #>  4     0.102     0.00360 5.16e-4 3.66e-4 1.07e-3 1.07e-4 1.13e-3 2.06e-4 6.73e-5 #>  5     0.0956    0.00315 5.20e-4 4.87e-4 8.73e-4 1.11e-4 8.40e-4 1.72e-4 0       #>  6     0.0940    0.00350 4.40e-4 3.11e-4 1.12e-3 2.28e-5 1.06e-3 1.52e-4 4.97e-5 #>  7     0.128     0.00578 7.84e-4 3.33e-4 1.13e-3 1.37e-4 1.40e-3 5.30e-4 1.49e-4 #>  8     0.0890    0.00345 4.83e-4 3.65e-4 1.04e-3 1.00e-4 9.51e-4 1.89e-4 8.42e-5 #>  9     0.0887    0.00317 4.69e-4 4.63e-4 8.29e-4 1.51e-4 9.22e-4 2.25e-4 4.32e-5 #> 10     0.0996    0.00369 5.39e-4 4.90e-4 8.66e-4 1.93e-4 1.00e-3 2.55e-4 1.63e-5 #> # … with 50 more rows, 1 more variable: p208.04518 <dbl>, and abbreviated #> #   variable names ¹​n193.02388, ²​n226.99693, ³​n228.97636, ⁴​n228.99274, #> #   ⁵​n231.00069, ⁶​n384.0495, ⁷​n385.04874"},{"path":"https://aberhrml.github.io/assignments/articles/assignments.html","id":"parameters","dir":"Articles","previous_headings":"","what":"Parameters","title":"assignments","text":"Default parameters number techniques provided. available techniques can viewed shown . FIE-HRMS fingerprinting technique parameters also suitable direct injection data. default parameters designed widely applicable possible suit many situations. example specify use FIE-HRMS parameters. parameters can viewed printing returned object. possible access set parameters. example, adducts method can used access specified adducts: accessor methods assignment parameters can viewed running ?parameters. Additional adducts, isotopes transformations rules can also appended relevant rules tables within assignment parameters object. See assignment parameters documentation information.","code":"availableTechniques() #> [1] \"FIE-HRMS\"   \"RP-LC-HRMS\" \"NP-LC-HRMS\" parameters <- assignmentParameters('FIE-HRMS') parameters #>  #> Assignment Parameters:  #>  #>   Technique:      FIE-HRMS  #>   Max M:          800  #>   MF rank threshold:  3  #>   PPM threshold:      6  #>   Relationship limit:     0.001  #>   RT limit:         #>   Correlations: #>      method: spearman #>          pAdjustMethod: bonferroni #>          corPvalue: 0.05 #>          minCoef: 0.7 #>          maxCor: Inf #>  #>   Adducts:  #>   n: [M-H]1-, [M+Cl]1-, [M+K-2H]1-, [M-2H]2-, [M+Cl37]1-, [2M-H]1- #>   p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+  #>   Isotopes: 13C, 18O, 13C2  #>   Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2] adducts(parameters) #> $n #> [1] \"[M-H]1-\"    \"[M+Cl]1-\"   \"[M+K-2H]1-\" \"[M-2H]2-\"   \"[M+Cl37]1-\" #> [6] \"[2M-H]1-\"   #>  #> $p #> [1] \"[M+H]1+\"   \"[M+K]1+\"   \"[M+Na]1+\"  \"[M+K41]1+\" \"[M+2H]2+\"  \"[2M+H]1+\""},{"path":"https://aberhrml.github.io/assignments/articles/assignments.html","id":"assignment","dir":"Articles","previous_headings":"","what":"Assignment","title":"assignments","text":"perform molecular formula assignment can execute following. overview assignment results, can print object.","code":"assignment <- assignMFs(feature_data,                         parameters) #>  [34m #> assignments  [39m [31mv1.0.0 [39m Tue Feb 21 16:07:10 2023 #> ________________________________________________________________________________ #>  [33mAssignment Parameters: [33m  [39m #>  #>   Technique:      FIE-HRMS  #>   Max M:          800  #>   MF rank threshold:  3  #>   PPM threshold:      6  #>   Relationship limit:     0.001  #>   RT limit:         #>   Correlations: #>      method: spearman #>          pAdjustMethod: bonferroni #>          corPvalue: 0.05 #>          minCoef: 0.7 #>          maxCor: Inf #>  #>   Adducts:  #>   n: [M-H]1-, [M+Cl]1-, [M+K-2H]1-, [M-2H]2-, [M+Cl37]1-, [2M-H]1- #>   p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+  #>   Isotopes: 13C, 18O, 13C2  #>   Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2] #> ________________________________________________________________________________ #> No. m/z: 10 #>  [34mCalculating correlations  [39m…  [34mCalculating correlations  [39m  [32m✔ [39m [10 correlations] [0.5S] #>  [34mCalculating relationships  [39m…  [34mCalculating relationships  [39m     [32m✔ [39m [12.2S] #>  [34mAdduct & isotopic assignment  [39m… #> generating molecular formulas… generating molecular formulas    [32m✔ [39m [26.5S] #> iteration 1… iteration 1          [32m✔ [39m [5.8S] #> iteration 2…  [34mAdduct & isotopic assignment  [39m  [32m✔ [39m [36.5S] #>  [34mTransformation assignment [39m… #> iteration 1 … iteration 1              [32m✔ [39m [8.3S] #> iteration 2 …  [34mTransformation assignment  [39m     [32m✔ [39m [8.3S] #> ________________________________________________________________________________ #>  #>  [32mComplete!  [39m[58.3S] assignment #>  #> assignments v1.0.0  #> Assignment:  #>   Features:       10  #>   Correlations:       10  #>   Relationships:      52  #>  #>   Adduct & isotope assignment:  #>       Iterations:     1  #>       MFs:        1  #>       Assigned:   5  #>  #>   Transformation assignment:  #>       Iterations:     1  #>       MFs:        1  #>       Assigned:   1  #>  #>   Total assignments:  6 (60%)  #>   Unique MFs:         2"},{"path":"https://aberhrml.github.io/assignments/articles/assignments.html","id":"results","dir":"Articles","previous_headings":"","what":"Results","title":"assignments","text":"following can used access assigned m/z feature information. feature assignments can also summarised molecular formula. can extract calculated correlations m/z features. well computed mathematical adduct, isotope transformation relationships. view iterations conducted assignment, following can used. Information component subgraphs identified iteration can also extracted. can either selected components possible components. can extract tidygraph tbl_graph object given iterations. Along graph individual component. components given feature. graph individual component can visualised. first requires ggraph package loaded.  can also visualise components containing specific feature given iteration.  molecular formula ranking threshold applied assignment, may also useful generate alternative molecular formulas rankings specific m/z, adduct isotope using ipMF function mzAnnotation package.","code":"assignments(assignment) #> # A tibble: 6 × 15 #>   Name      Feature Reten…¹ Isotope Adduct MF    Theor…² Measu…³ Theor…⁴ Measu…⁵ #>   <chr>     <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 n191.019… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191.    191. #> 2 n192.023… n192.0…      NA 13C     [M-H]… C6H8…    192.    192.    192.    192. #> 3 n193.023… n193.0…      NA 18O     [M-H]… C6H8…    192.    192.    193.    193. #> 4 n226.996… n226.9…      NA NA      [M+Cl… C6H8…    192.    192.    227.    227. #> 5 n228.992… n228.9…      NA NA      [M+Cl… C6H8…    192.    192.    229.    229. #> 6 p208.045… p208.0…      NA NA      [M+H]… C6H9…    207.    207.    208.    208. #> # … with 5 more variables: `PPM error` <dbl>, `MF Plausibility (%)` <dbl>, #> #   Mode <chr>, Component <dbl>, Iteration <chr>, and abbreviated variable #> #   names ¹​RetentionTime, ²​`Theoretical M`, ³​`Measured M`, ⁴​`Theoretical m/z`, #> #   ⁵​`Measured m/z` summariseAssignments(assignment) #> # A tibble: 2 × 4 #>   MF      Features                                                 Isoto…¹ Count #>   <chr>   <chr>                                                    <chr>   <int> #> 1 C6H8O7  n191.01962; n192.02306; n193.02388; n226.99693; n228.99… \" [M-H…     5 #> 2 C6H9NO7 p208.04518                                               \" [M+H…     1 #> # … with abbreviated variable name ¹​`Isotopes & Ionisation Products` correlations(assignment) #> # A tibble: 10 × 12 #>    Feature1   Feature2 Mode1 Mode2 `m/z1` `m/z2` Reten…¹ Reten…² Reten…³ log2I…⁴ #>    <chr>      <chr>    <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA    0    #>  2 n191.01962 n192.02… n     n       191.   192.      NA      NA      NA    4.80 #>  3 n192.02306 p208.04… n     p       192.   208.      NA      NA      NA   -4.80 #>  4 n231.00069 n384.04… n     n       231.   384.      NA      NA      NA    2.36 #>  5 n226.99693 n228.99… n     n       227.   229.      NA      NA      NA    1.74 #>  6 n191.01962 n193.02… n     n       191.   193.      NA      NA      NA    7.56 #>  7 n193.02388 p208.04… n     p       193.   208.      NA      NA      NA   -7.56 #>  8 n192.02306 n193.02… n     n       192.   193.      NA      NA      NA    2.76 #>  9 n191.01962 n231.00… n     n       191.   231.      NA      NA      NA    6.96 #> 10 n231.00069 p208.04… n     p       231.   208.      NA      NA      NA   -6.96 #> # … with 2 more variables: coefficient <dbl>, ID <int>, and abbreviated #> #   variable names ¹​RetentionTime1, ²​RetentionTime2, ³​RetentionTimeDiff, #> #   ⁴​log2IntensityRatio relationships(assignment) #> # A tibble: 52 × 19 #>    Feature1   Feature2 Mode1 Mode2 `m/z1` `m/z2` Reten…¹ Reten…² Reten…³ Adduct1 #>    <chr>      <chr>    <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl> <chr>   #>  1 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  2 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  3 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  4 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  5 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  6 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  7 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  8 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  9 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #> 10 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #> # … with 42 more rows, 9 more variables: Adduct2 <chr>, Isotope1 <chr>, #> #   Isotope2 <chr>, Transformation1 <chr>, Transformation2 <chr>, #> #   log2IntensityRatio <dbl>, coefficient <dbl>, Error <dbl>, ID <int>, and #> #   abbreviated variable names ¹​RetentionTime1, ²​RetentionTime2, #> #   ³​RetentionTimeDiff iterations(assignment) #> [1] \"A&I1\" \"T1\" components(assignment,            iteration = 'A&I1',            type = 'selected') #> # A tibble: 2 × 6 #>   Component  Size Nodes Degree Density `Component Plausibility` #>       <dbl> <dbl> <int>  <dbl>   <dbl>                    <dbl> #> 1         1     3     3      2       1                0.000346  #> 2        24     1     2      1       1                0.0000272 graph(assignment,       iteration = 'A&I1',       type = 'selected') #> # A tbl_graph: 5 nodes and 4 edges #> # #> # An undirected simple graph with 2 components #> # #> # Node Data: 5 × 21 (active) #>   name  Feature Retent… Isotope Adduct MF    Theore… Measur… Theore… Measur… #>   <chr> <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 n191… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191.    191. #> 2 n192… n192.0…      NA 13C     [M-H]… C6H8…    192.    192.    192.    192. #> 3 n193… n193.0…      NA 18O     [M-H]… C6H8…    192.    192.    193.    193. #> 4 n226… n226.9…      NA NA      [M+Cl… C6H8…    192.    192.    227.    227. #> 5 n228… n228.9…      NA NA      [M+Cl… C6H8…    192.    192.    229.    229. #> # … with 11 more variables: `PPM error` <dbl>, `MF Plausibility (%)` <dbl>, #> #   AIS <dbl>, ID <int>, Component <dbl>, Size <dbl>, Nodes <int>, #> #   Degree <dbl>, Density <dbl>, `Component Plausibility` <dbl>, Weight <dbl> #> # #> # Edge Data: 4 × 23 #>    from    to Featur… Featur… Mode1 Mode2 `m/z1` `m/z2` Retent… Retent… Retent… #>   <int> <int> <chr>   <chr>   <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl> #> 1     1     2 n191.0… n192.0… n     n       191.   192.      NA      NA      NA #> 2     1     3 n191.0… n193.0… n     n       191.   193.      NA      NA      NA #> 3     2     3 n192.0… n193.0… n     n       192.   193.      NA      NA      NA #> # … with 1 more row, and 12 more variables: Adduct1 <chr>, Adduct2 <chr>, #> #   Isotope1 <chr>, Isotope2 <chr>, Transformation1 <chr>, #> #   Transformation2 <chr>, log2IntensityRatio <dbl>, coefficient <dbl>, #> #   Error <dbl>, ID <int>, MF1 <chr>, MF2 <chr> component(assignment,           component = 1,           iteration = 'A&I1',           type = 'selected') #> # A tbl_graph: 3 nodes and 3 edges #> # #> # An undirected simple graph with 1 component #> # #> # Node Data: 3 × 21 (active) #>   name  Feature Retent… Isotope Adduct MF    Theore… Measur… Theore… Measur… #>   <chr> <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 n191… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191.    191. #> 2 n192… n192.0…      NA 13C     [M-H]… C6H8…    192.    192.    192.    192. #> 3 n193… n193.0…      NA 18O     [M-H]… C6H8…    192.    192.    193.    193. #> # … with 11 more variables: `PPM error` <dbl>, `MF Plausibility (%)` <dbl>, #> #   AIS <dbl>, ID <int>, Component <dbl>, Size <dbl>, Nodes <int>, #> #   Degree <dbl>, Density <dbl>, `Component Plausibility` <dbl>, Weight <dbl> #> # #> # Edge Data: 3 × 23 #>    from    to Featur… Featur… Mode1 Mode2 `m/z1` `m/z2` Retent… Retent… Retent… #>   <int> <int> <chr>   <chr>   <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl> #> 1     1     2 n191.0… n192.0… n     n       191.   192.      NA      NA      NA #> 2     1     3 n191.0… n193.0… n     n       191.   193.      NA      NA      NA #> 3     2     3 n192.0… n193.0… n     n       192.   193.      NA      NA      NA #> # … with 12 more variables: Adduct1 <chr>, Adduct2 <chr>, Isotope1 <chr>, #> #   Isotope2 <chr>, Transformation1 <chr>, Transformation2 <chr>, #> #   log2IntensityRatio <dbl>, coefficient <dbl>, Error <dbl>, ID <int>, #> #   MF1 <chr>, MF2 <chr> featureComponents(assignment,                   feature = 'n191.01962',                   type = 'all') #> # A tibble: 12 × 22 #>    Iteration name   Feature Reten…¹ Isotope Adduct MF    Theor…² Measu…³ Theor…⁴ #>    <chr>     <chr>  <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl> #>  1 A&I1      n191.… n191.0…      NA NA      [M-H]… C6H8…   192.    192.     191. #>  2 A&I1      n191.… n191.0…      NA NA      [M-H]… C7H1…   192.    192.     191. #>  3 A&I1      n191.… n191.0…      NA NA      [M+Cl… C2H1…   156.    156.     191. #>  4 A&I1      n191.… n191.0…      NA NA      [M+Cl… CH8N…   156.    156.     191. #>  5 A&I1      n191.… n191.0…      NA NA      [M+Cl… C3H1…   156.    156.     191. #>  6 A&I1      n191.… n191.0…      NA NA      [M+K-… C4H1…   154.    154.     191. #>  7 A&I1      n191.… n191.0…      NA NA      [M+K-… C2H2…   154.    154.     191. #>  8 A&I1      n191.… n191.0…      NA NA      [M-2H… C12H…   384.    384.     191. #>  9 A&I1      n191.… n191.0…      NA NA      [M-2H… C13H…   384.    384.     191. #> 10 A&I1      n191.… n191.0…      NA NA      [2M-H… CH8N…    96.0    96.0    191. #> 11 A&I1      n191.… n191.0…      NA NA      [M+K-… H15N…   154.    154.     191. #> 12 T1        n191.… n191.0…      NA NA      [M-H]… C6H8…   192.    192.     191. #> # … with 12 more variables: `Measured m/z` <dbl>, `PPM error` <dbl>, #> #   `MF Plausibility (%)` <dbl>, AIS <dbl>, ID <int>, Component <dbl>, #> #   Weight <dbl>, Size <dbl>, Nodes <int>, Degree <dbl>, Density <dbl>, #> #   `Component Plausibility` <dbl>, and abbreviated variable names #> #   ¹​RetentionTime, ²​`Theoretical M`, ³​`Measured M`, ⁴​`Theoretical m/z` library(ggraph) #> Loading required package: ggplot2  plotComponent(assignment,               component = 1,               iteration = 'A&I1',               type = 'selected') plotFeatureComponents(   assignment,   feature = 'n191.01962',   iteration = 'A&I1',   type = 'all',   max_components = 6,   axis_offset = 0.2 ) mzAnnotation::ipMF(191.01962,      adduct = '[M-H]1-',      isotope = NA,      ppm = 6) #> # A tibble: 13 × 9 #>    MF         Adduct  Isotope Measured…¹ Measu…² Theor…³ Theor…⁴ PPM e…⁵ Plaus…⁶ #>    <chr>      <chr>   <lgl>        <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1 C6H8O7     [M-H]1- NA            191.    192.    191.    192.   0.576   100   #>  2 C7H12O2S2  [M-H]1- NA            191.    192.    191.    192.   5.13     97.8 #>  3 C10H10P2   [M-H]1- NA            191.    192.    191.    192.   5.92     97.7 #>  4 CH5N8O2P   [M-H]1- NA            191.    192.    191.    192.   2.15     70.1 #>  5 C5H10N3OS2 [M-H]1- NA            191.    192.    191.    192.   1.88     69.0 #>  6 H9N4O6P    [M-H]1- NA            191.    192.    191.    192.   4.87     68.8 #>  7 C6H13NP3   [M-H]1- NA            191.    192.    191.    192.   4.24     66.5 #>  8 H19O3P3S   [M-H]1- NA            191.    192.    191.    192.   0.576    66.2 #>  9 C2H16N2P4  [M-H]1- NA            191.    192.    191.    192.   2.62     60.4 #> 10 C2H11NO7P  [M-H]1- NA            191.    192.    191.    192.   2.25     60.2 #> 11 C5H2N7O2   [M-H]1- NA            191.    192.    191.    192.   0.471    59.9 #> 12 CH13N4OPS2 [M-H]1- NA            191.    192.    191.    192.   0.209    57.9 #> 13 CH21PS4    [M-H]1- NA            191.    192.    191.    192.   2.72     57.9 #> # … with abbreviated variable names ¹​`Measured m/z`, ²​`Measured M`, #> #   ³​`Theoretical m/z`, ⁴​`Theoretical M`, ⁵​`PPM error`, ⁶​`Plausibility (%)`"},{"path":"https://aberhrml.github.io/assignments/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jasen Finch. Author, maintainer.","code":""},{"path":"https://aberhrml.github.io/assignments/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Finch J (2023). assignments: Molecular Formula Assignment High Resolution ESI-MS Based Metabolomics Data. R package version 1.0.0, https://aberhrml.github.io/assignments/.","code":"@Manual{,   title = {assignments: Molecular Formula Assignment For High Resolution ESI-MS Based Metabolomics Data},   author = {Jasen Finch},   year = {2023},   note = {R package version 1.0.0},   url = {https://aberhrml.github.io/assignments/}, }"},{"path":"https://aberhrml.github.io/assignments/index.html","id":"assignments","dir":"","previous_headings":"","what":"Molecular Formula Assignment For High Resolution ESI-MS Based Metabolomics Data","title":"Molecular Formula Assignment For High Resolution ESI-MS Based Metabolomics Data","text":"R package automated molecular formula assignment ultra-high resolution ESI-MS based metabolomics data","code":""},{"path":"https://aberhrml.github.io/assignments/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Molecular Formula Assignment For High Resolution ESI-MS Based Metabolomics Data","text":"R package provides automated molecular formula assignment approach electrospray ionisation ultra-high resolution mass spectrometry (ESI-HRMS) metabolomics data. includes data direct flow injection/infustion (FIE-HRMS) fingerprinting well liquid chromatography mass spectrometry (LC-HRMS) profiling. approach includes correlation analysis, relationship calculation, molecular formula generation selection graphical component selection based adducts, isotopes transformations.","code":""},{"path":"https://aberhrml.github.io/assignments/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Molecular Formula Assignment For High Resolution ESI-MS Based Metabolomics Data","text":"assignments package can installed GitHub using following:","code":"remotes::install_github('aberHRML/assignments')"},{"path":"https://aberhrml.github.io/assignments/index.html","id":"learn-more","dir":"","previous_headings":"","what":"Learn more","title":"Molecular Formula Assignment For High Resolution ESI-MS Based Metabolomics Data","text":"package documentation can browsed online https://aberHRML.github.io/assignments/. first time using assignments see vignette information get started. believe ’ve found bug assignments, please file bug (, possible, reproducible example) https://github.com/aberHRML/assignments/issues.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/Assignment-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Assignment — Assignment-class","title":"Assignment — Assignment-class","text":"S4 class store molecular formula assignment results.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/Assignment-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Assignment — Assignment-class","text":"log list containing assignment logs data tibble containing m/z peak intensity matrix correlations tibble containing correlations analysis results relationships tibble containing calculated mathematical relationships addIsoAssign list containing results adduct isotope assignment iterations transAssign list containing results transformation assignment iterationst assignments tibble containing assigned molecular formulas","code":""},{"path":"https://aberhrml.github.io/assignments/reference/AssignmentParameters-class.html","id":null,"dir":"Reference","previous_headings":"","what":"S4 class for assignment parameters — AssignmentParameters-class","title":"S4 class for assignment parameters — AssignmentParameters-class","text":"S4 class store assignment parameters.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/AssignmentParameters-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"S4 class for assignment parameters — AssignmentParameters-class","text":"technique analytical technique correlations_parameters list correlation parameters passed metabolyseR::correlations() max_M maximum molecular mass assign molecular formulas MF_rank_threshold rank threshold molecular formula selection ppm parts per million error threshold limit atomic mass unit deviation limit relationship calculation RT_diff_limit limit retention time differences correlated features adduct isotopic assignment adducts list character vectors containing adducts names. List element names denote ionisation mode. order adducts provided denotes expected relative importance assignments first expected common last least common within ionisation mode. isotopes character vector isotopes use. Similarly adducts, order denotes expected commonality data. transformations character vector transformations molecular formula changes adduct_rules tibble containing adduct formation rules returned mzAnnotation::adduct_rules() isotope_rules tibble containing isotope rules returned mzAnnotation::isotope_rules() transformation_rules tibble containing transformation rules returned mzAnnotation::transformation_rules()","code":""},{"path":"https://aberhrml.github.io/assignments/reference/accessors.html","id":null,"dir":"Reference","previous_headings":"","what":"Assignment accessors — featureData","title":"Assignment accessors — featureData","text":"Access methods Assignment S4 class","code":""},{"path":"https://aberhrml.github.io/assignments/reference/accessors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assignment accessors — featureData","text":"","code":"featureData(assignment)  # S4 method for Assignment featureData(assignment)  correlations(assignment)  # S4 method for Assignment correlations(assignment)  relationships(assignment)  # S4 method for Assignment relationships(assignment)  iterations(assignment)  # S4 method for Assignment iterations(assignment)  graph(assignment, iteration, type = c(\"selected\", \"all\"))  # S4 method for Assignment graph(assignment, iteration, type = c(\"selected\", \"all\"))  components(assignment, iteration, type = c(\"selected\", \"all\"))  # S4 method for Assignment components(assignment, iteration, type = c(\"selected\", \"all\"))  featureComponents(assignment, feature, type = c(\"selected\", \"all\"))  # S4 method for Assignment featureComponents(assignment, feature, type = c(\"selected\", \"all\"))  component(assignment, component, iteration, type = c(\"selected\", \"all\"))  # S4 method for Assignment component(assignment, component, iteration, type = c(\"selected\", \"all\"))  assignments(assignment)  # S4 method for Assignment assignments(assignment)  assignedData(assignment)  # S4 method for Assignment assignedData(assignment)  summariseAssignments(assignment)  # S4 method for Assignment summariseAssignments(assignment)"},{"path":"https://aberhrml.github.io/assignments/reference/accessors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assignment accessors — featureData","text":"assignment S4 object class Assignment iteration assignment iteration type graph type return. filtered returns assignment graph component selection. returns assignment components. feature feature information extract component component number extract","code":""},{"path":"https://aberhrml.github.io/assignments/reference/accessors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assignment accessors — featureData","text":"tibble tbl_graph containing assignment results depending method used.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/accessors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assignment accessors — featureData","text":"featureData - Return initially specifed m/z feature data. correlations - Return correlation analysis results. relationships - Return calculated relationships. iterations - Return assignment iteration performed. graph - Return selected graph. components - Return component information assignment iteration. featureComponents - Return component information selected feature. component - Extract component graph. assignments - Return molecular formulas assigned m/z features. assignedData - Return m/z peak intensity matrix molecular formula assignments included column names. summariseAssignments - Return tibble assignments summarised molecular formula.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/accessors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assignment accessors — featureData","text":"","code":"plan(future::sequential) p <- assignmentParameters('FIE-HRMS')  mf_assignments <- assignMFs(feature_data,p) #>  #> assignments v1.0.0 Tue Feb 21 16:03:07 2023 #> ________________________________________________________________________________ #> Assignment Parameters:  #>  #> \t Technique:\t\t FIE-HRMS  #> \t Max M:\t\t\t 800  #> \t MF rank threshold:\t 3  #> \t PPM threshold:\t\t 6  #> \t Relationship limit:\t 0.001  #> \t RT limit:\t\t   #> \t Correlations: #> \t\tmethod: spearman #>  \t\tpAdjustMethod: bonferroni #>  \t\tcorPvalue: 0.05 #>  \t\tminCoef: 0.7 #>  \t\tmaxCor: Inf #>  #> \t Adducts:  #> \t n: [M-H]1-, [M+Cl]1-, [M+K-2H]1-, [M-2H]2-, [M+Cl37]1-, [2M-H]1- #> \t p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+  #> \t Isotopes: 13C, 18O, 13C2  #> \t Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2] #> ________________________________________________________________________________ #> No. m/z:\t10 #> Calculating correlations … #> Calculating correlations \t✔ [10 correlations] [0.6S] #> Calculating relationships … #> Calculating relationships \t✔ [4.7S] #> Adduct & isotopic assignment … #> generating molecular formulas… #> generating molecular formulas\t✔ [46.2S] #> iteration 1… #> iteration 1\t\t\t✔ [1.1S] #> iteration 2… #> Adduct & isotopic assignment \t✔ [49.5S] #> Transformation assignment… #> iteration 1 … #> iteration 1 \t\t\t✔ [2.7S] #> iteration 2 … #> Transformation assignment \t✔ [2.8S] #> ________________________________________________________________________________ #>  #> Complete! [58.4S]  ## Return feature data featureData(mf_assignments) #> # A tibble: 60 × 10 #>    n191.01962 n192.02306 n193.…¹ n226.…² n228.…³ n228.…⁴ n231.…⁵ n384.…⁶ n385.…⁷ #>         <dbl>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1     0.109     0.00401 6.09e-4 4.17e-4 1.35e-3 9.12e-5 1.22e-3 3.11e-4 3.10e-5 #>  2     0.0955    0.00346 4.66e-4 3.06e-4 1.10e-3 8.47e-5 8.31e-4 1.00e-4 8.88e-7 #>  3     0.109     0.00418 6.37e-4 2.94e-4 1.13e-3 8.79e-5 1.26e-3 3.64e-4 8.01e-5 #>  4     0.102     0.00360 5.16e-4 3.66e-4 1.07e-3 1.07e-4 1.13e-3 2.06e-4 6.73e-5 #>  5     0.0956    0.00315 5.20e-4 4.87e-4 8.73e-4 1.11e-4 8.40e-4 1.72e-4 0       #>  6     0.0940    0.00350 4.40e-4 3.11e-4 1.12e-3 2.28e-5 1.06e-3 1.52e-4 4.97e-5 #>  7     0.128     0.00578 7.84e-4 3.33e-4 1.13e-3 1.37e-4 1.40e-3 5.30e-4 1.49e-4 #>  8     0.0890    0.00345 4.83e-4 3.65e-4 1.04e-3 1.00e-4 9.51e-4 1.89e-4 8.42e-5 #>  9     0.0887    0.00317 4.69e-4 4.63e-4 8.29e-4 1.51e-4 9.22e-4 2.25e-4 4.32e-5 #> 10     0.0996    0.00369 5.39e-4 4.90e-4 8.66e-4 1.93e-4 1.00e-3 2.55e-4 1.63e-5 #> # … with 50 more rows, 1 more variable: p208.04518 <dbl>, and abbreviated #> #   variable names ¹​n193.02388, ²​n226.99693, ³​n228.97636, ⁴​n228.99274, #> #   ⁵​n231.00069, ⁶​n384.0495, ⁷​n385.04874  ## Return correlations correlations(mf_assignments) #> # A tibble: 10 × 12 #>    Feature1   Feature2 Mode1 Mode2 `m/z1` `m/z2` Reten…¹ Reten…² Reten…³ log2I…⁴ #>    <chr>      <chr>    <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA    0    #>  2 n191.01962 n192.02… n     n       191.   192.      NA      NA      NA    4.80 #>  3 n192.02306 p208.04… n     p       192.   208.      NA      NA      NA   -4.80 #>  4 n231.00069 n384.04… n     n       231.   384.      NA      NA      NA    2.36 #>  5 n226.99693 n228.99… n     n       227.   229.      NA      NA      NA    1.74 #>  6 n191.01962 n193.02… n     n       191.   193.      NA      NA      NA    7.56 #>  7 n193.02388 p208.04… n     p       193.   208.      NA      NA      NA   -7.56 #>  8 n192.02306 n193.02… n     n       192.   193.      NA      NA      NA    2.76 #>  9 n191.01962 n231.00… n     n       191.   231.      NA      NA      NA    6.96 #> 10 n231.00069 p208.04… n     p       231.   208.      NA      NA      NA   -6.96 #> # … with 2 more variables: coefficient <dbl>, ID <int>, and abbreviated #> #   variable names ¹​RetentionTime1, ²​RetentionTime2, ³​RetentionTimeDiff, #> #   ⁴​log2IntensityRatio  ## Return relationships relationships(mf_assignments) #> # A tibble: 52 × 19 #>    Feature1   Feature2 Mode1 Mode2 `m/z1` `m/z2` Reten…¹ Reten…² Reten…³ Adduct1 #>    <chr>      <chr>    <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl> <chr>   #>  1 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  2 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  3 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  4 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M-H]1- #>  5 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  6 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  7 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  8 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #>  9 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #> 10 n191.01962 p208.04… n     p       191.   208.      NA      NA      NA [M+K-2… #> # … with 42 more rows, 9 more variables: Adduct2 <chr>, Isotope1 <chr>, #> #   Isotope2 <chr>, Transformation1 <chr>, Transformation2 <chr>, #> #   log2IntensityRatio <dbl>, coefficient <dbl>, Error <dbl>, ID <int>, and #> #   abbreviated variable names ¹​RetentionTime1, ²​RetentionTime2, #> #   ³​RetentionTimeDiff  ## Return the available iterations iterations(mf_assignments) #> [1] \"A&I1\" \"T1\"    ## Return a selected graph graph(mf_assignments,'A&I1') #> # A tbl_graph: 5 nodes and 4 edges #> # #> # An undirected simple graph with 2 components #> # #> # Node Data: 5 × 21 (active) #>   name  Feature Retent… Isotope Adduct MF    Theore… Measur… Theore… Measur… #>   <chr> <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 n191… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191.    191. #> 2 n192… n192.0…      NA 13C     [M-H]… C6H8…    192.    192.    192.    192. #> 3 n193… n193.0…      NA 18O     [M-H]… C6H8…    192.    192.    193.    193. #> 4 n226… n226.9…      NA NA      [M+Cl… C6H8…    192.    192.    227.    227. #> 5 n228… n228.9…      NA NA      [M+Cl… C6H8…    192.    192.    229.    229. #> # … with 11 more variables: `PPM error` <dbl>, `MF Plausibility (%)` <dbl>, #> #   AIS <dbl>, ID <int>, Component <dbl>, Size <dbl>, Nodes <int>, #> #   Degree <dbl>, Density <dbl>, `Component Plausibility` <dbl>, Weight <dbl> #> # #> # Edge Data: 4 × 23 #>    from    to Featur… Featur… Mode1 Mode2 `m/z1` `m/z2` Retent… Retent… Retent… #>   <int> <int> <chr>   <chr>   <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl> #> 1     1     2 n191.0… n192.0… n     n       191.   192.      NA      NA      NA #> 2     1     3 n191.0… n193.0… n     n       191.   193.      NA      NA      NA #> 3     2     3 n192.0… n193.0… n     n       192.   193.      NA      NA      NA #> # … with 1 more row, and 12 more variables: Adduct1 <chr>, Adduct2 <chr>, #> #   Isotope1 <chr>, Isotope2 <chr>, Transformation1 <chr>, #> #   Transformation2 <chr>, log2IntensityRatio <dbl>, coefficient <dbl>, #> #   Error <dbl>, ID <int>, MF1 <chr>, MF2 <chr>  ## Return a component information for a selected graph components(mf_assignments,'A&I1') #> # A tibble: 2 × 6 #>   Component  Size Nodes Degree Density `Component Plausibility` #>       <dbl> <dbl> <int>  <dbl>   <dbl>                    <dbl> #> 1         1     3     3      2       1                0.000346  #> 2        24     1     2      1       1                0.0000272  ## Return a component information for a selected feature featureComponents(mf_assignments,'n191.01962') #> # A tibble: 2 × 22 #>   Iteration name    Feature Reten…¹ Isotope Adduct MF    Theor…² Measu…³ Theor…⁴ #>   <chr>     <chr>   <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl> #> 1 A&I1      n191.0… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191. #> 2 T1        n191.0… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191. #> # … with 12 more variables: `Measured m/z` <dbl>, `PPM error` <dbl>, #> #   `MF Plausibility (%)` <dbl>, AIS <dbl>, ID <int>, Component <dbl>, #> #   Size <dbl>, Nodes <int>, Degree <dbl>, Density <dbl>, #> #   `Component Plausibility` <dbl>, Weight <dbl>, and abbreviated variable #> #   names ¹​RetentionTime, ²​`Theoretical M`, ³​`Measured M`, ⁴​`Theoretical m/z`   ## Extract a component graph component(mf_assignments,1,'A&I1') #> # A tbl_graph: 3 nodes and 3 edges #> # #> # An undirected simple graph with 1 component #> # #> # Node Data: 3 × 21 (active) #>   name  Feature Retent… Isotope Adduct MF    Theore… Measur… Theore… Measur… #>   <chr> <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 n191… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191.    191. #> 2 n192… n192.0…      NA 13C     [M-H]… C6H8…    192.    192.    192.    192. #> 3 n193… n193.0…      NA 18O     [M-H]… C6H8…    192.    192.    193.    193. #> # … with 11 more variables: `PPM error` <dbl>, `MF Plausibility (%)` <dbl>, #> #   AIS <dbl>, ID <int>, Component <dbl>, Size <dbl>, Nodes <int>, #> #   Degree <dbl>, Density <dbl>, `Component Plausibility` <dbl>, Weight <dbl> #> # #> # Edge Data: 3 × 23 #>    from    to Featur… Featur… Mode1 Mode2 `m/z1` `m/z2` Retent… Retent… Retent… #>   <int> <int> <chr>   <chr>   <chr> <chr>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl> #> 1     1     2 n191.0… n192.0… n     n       191.   192.      NA      NA      NA #> 2     1     3 n191.0… n193.0… n     n       191.   193.      NA      NA      NA #> 3     2     3 n192.0… n193.0… n     n       192.   193.      NA      NA      NA #> # … with 12 more variables: Adduct1 <chr>, Adduct2 <chr>, Isotope1 <chr>, #> #   Isotope2 <chr>, Transformation1 <chr>, Transformation2 <chr>, #> #   log2IntensityRatio <dbl>, coefficient <dbl>, Error <dbl>, ID <int>, #> #   MF1 <chr>, MF2 <chr>  ## Return assignments assignments(mf_assignments) #> # A tibble: 6 × 15 #>   Name      Feature Reten…¹ Isotope Adduct MF    Theor…² Measu…³ Theor…⁴ Measu…⁵ #>   <chr>     <chr>     <dbl> <chr>   <chr>  <chr>   <dbl>   <dbl>   <dbl>   <dbl> #> 1 n191.019… n191.0…      NA NA      [M-H]… C6H8…    192.    192.    191.    191. #> 2 n192.023… n192.0…      NA 13C     [M-H]… C6H8…    192.    192.    192.    192. #> 3 n193.023… n193.0…      NA 18O     [M-H]… C6H8…    192.    192.    193.    193. #> 4 n226.996… n226.9…      NA NA      [M+Cl… C6H8…    192.    192.    227.    227. #> 5 n228.992… n228.9…      NA NA      [M+Cl… C6H8…    192.    192.    229.    229. #> 6 p208.045… p208.0…      NA NA      [M+H]… C6H9…    207.    207.    208.    208. #> # … with 5 more variables: `PPM error` <dbl>, `MF Plausibility (%)` <dbl>, #> #   Mode <chr>, Component <dbl>, Iteration <chr>, and abbreviated variable #> #   names ¹​RetentionTime, ²​`Theoretical M`, ³​`Measured M`, ⁴​`Theoretical m/z`, #> #   ⁵​`Measured m/z`  ## Return an m/z intensity matrix with the assignments included ## in the column names assignedData(mf_assignments) #> # A tibble: 60 × 10 #>    n191.01962 …¹ n192.…² n193.…³ n226.…⁴ n228.…⁵ n228.…⁶ n231.…⁷ n384.…⁸ n385.…⁹ #>            <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> #>  1        0.109  0.00401 6.09e-4 4.17e-4 1.35e-3 9.12e-5 1.22e-3 3.11e-4 3.10e-5 #>  2        0.0955 0.00346 4.66e-4 3.06e-4 1.10e-3 8.47e-5 8.31e-4 1.00e-4 8.88e-7 #>  3        0.109  0.00418 6.37e-4 2.94e-4 1.13e-3 8.79e-5 1.26e-3 3.64e-4 8.01e-5 #>  4        0.102  0.00360 5.16e-4 3.66e-4 1.07e-3 1.07e-4 1.13e-3 2.06e-4 6.73e-5 #>  5        0.0956 0.00315 5.20e-4 4.87e-4 8.73e-4 1.11e-4 8.40e-4 1.72e-4 0       #>  6        0.0940 0.00350 4.40e-4 3.11e-4 1.12e-3 2.28e-5 1.06e-3 1.52e-4 4.97e-5 #>  7        0.128  0.00578 7.84e-4 3.33e-4 1.13e-3 1.37e-4 1.40e-3 5.30e-4 1.49e-4 #>  8        0.0890 0.00345 4.83e-4 3.65e-4 1.04e-3 1.00e-4 9.51e-4 1.89e-4 8.42e-5 #>  9        0.0887 0.00317 4.69e-4 4.63e-4 8.29e-4 1.51e-4 9.22e-4 2.25e-4 4.32e-5 #> 10        0.0996 0.00369 5.39e-4 4.90e-4 8.66e-4 1.93e-4 1.00e-3 2.55e-4 1.63e-5 #> # … with 50 more rows, 1 more variable: `p208.04518 C6H9NO7  [M+H]1+` <dbl>, #> #   and abbreviated variable names ¹​`n191.01962 C6H8O7  [M-H]1-`, #> #   ²​`n192.02306 C6H8O7 13C [M-H]1-`, ³​`n193.02388 C6H8O7 18O [M-H]1-`, #> #   ⁴​`n226.99693 C6H8O7  [M+Cl]1-`, ⁵​n228.97636, #> #   ⁶​`n228.99274 C6H8O7  [M+Cl37]1-`, ⁷​n231.00069, ⁸​n384.0495, ⁹​n385.04874  ## Return the assignments summarised by molecular formula summariseAssignments(mf_assignments) #> # A tibble: 2 × 4 #>   MF      Features                                                 Isoto…¹ Count #>   <chr>   <chr>                                                    <chr>   <int> #> 1 C6H8O7  n191.01962; n192.02306; n193.02388; n226.99693; n228.99… \" [M-H…     5 #> 2 C6H9NO7 p208.04518                                               \" [M+H…     1 #> # … with abbreviated variable name ¹​`Isotopes & Ionisation Products`"},{"path":"https://aberhrml.github.io/assignments/reference/assign.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform molecular formula assignment — assignMFs","title":"Perform molecular formula assignment — assignMFs","text":"Perform automated molecular formula assignment.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assign.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform molecular formula assignment — assignMFs","text":"","code":"assignMFs(   feature_data,   parameters = assignmentParameters(\"FIE-HRMS\"),   verbose = TRUE,   ... )  # S4 method for tbl_df assignMFs(   feature_data,   parameters = assignmentParameters(\"FIE-HRMS\"),   verbose = TRUE )  # S4 method for AnalysisData assignMFs(   feature_data,   parameters = assignmentParameters(\"FIE\"),   verbose = TRUE )  # S4 method for Analysis assignMFs(   feature_data,   parameters = assignmentParameters(\"FIE\"),   verbose = TRUE,   type = c(\"pre-treated\", \"raw\") )"},{"path":"https://aberhrml.github.io/assignments/reference/assign.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform molecular formula assignment — assignMFs","text":"feature_data tibble object S4 class AnalysisData Analysis containing feature intensity matrix m/z assign molecular formulas. See details. parameters S4 object class AssignmentParamters containing parameters molecular formula assignment verbose progress output printed console ... arguments pass relevant method type pre-treated raw data perform assignment argument feature_data S4 class Analysis","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assign.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform molecular formula assignment — assignMFs","text":"argument feature_data specified tibble, feature intensity matrix columns m/z features assign rows individual observations, cells abundance values. m/z features provided column names form <ionisation_mode><m/z>@<retention_time>. Ionisation mode given prefix n p negative positive ionisation modes respectively. Feature m/z provided accuracy least 5 decimal places. retention time portion (@<retention_time>) required LC-MS data provided minutes.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assign.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform molecular formula assignment — assignMFs","text":"","code":"plan(future::sequential) p <- assignmentParameters('FIE-HRMS')  assignments <- assignMFs(feature_data,p) #>  #> assignments v1.0.0 Tue Feb 21 16:04:07 2023 #> ________________________________________________________________________________ #> Assignment Parameters:  #>  #> \t Technique:\t\t FIE-HRMS  #> \t Max M:\t\t\t 800  #> \t MF rank threshold:\t 3  #> \t PPM threshold:\t\t 6  #> \t Relationship limit:\t 0.001  #> \t RT limit:\t\t   #> \t Correlations: #> \t\tmethod: spearman #>  \t\tpAdjustMethod: bonferroni #>  \t\tcorPvalue: 0.05 #>  \t\tminCoef: 0.7 #>  \t\tmaxCor: Inf #>  #> \t Adducts:  #> \t n: [M-H]1-, [M+Cl]1-, [M+K-2H]1-, [M-2H]2-, [M+Cl37]1-, [2M-H]1- #> \t p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+  #> \t Isotopes: 13C, 18O, 13C2  #> \t Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2] #> ________________________________________________________________________________ #> No. m/z:\t10 #> Calculating correlations … #> Calculating correlations \t✔ [10 correlations] [0.5S] #> Calculating relationships … #> Calculating relationships \t✔ [4S] #> Adduct & isotopic assignment … #> generating molecular formulas… #> generating molecular formulas\t✔ [46.1S] #> iteration 1… #> iteration 1\t\t\t✔ [1.1S] #> iteration 2… #> Adduct & isotopic assignment \t✔ [49.4S] #> Transformation assignment… #> iteration 1 … #> iteration 1 \t\t\t✔ [2.7S] #> iteration 2 … #> Transformation assignment \t✔ [2.7S] #> ________________________________________________________________________________ #>  #> Complete! [57.5S]"},{"path":"https://aberhrml.github.io/assignments/reference/assignment-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Molecular formula assignment methods — calcCorrelations","title":"Molecular formula assignment methods — calcCorrelations","text":"methods provide access performing individual steps molecular formula assignment approach. See Details information best use instead assignMFs().","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Molecular formula assignment methods — calcCorrelations","text":"","code":"calcCorrelations(assignment)  # S4 method for Assignment calcCorrelations(assignment)  addIsoAssign(assignment)  # S4 method for Assignment addIsoAssign(assignment)  transformationAssign(assignment)  # S4 method for Assignment transformationAssign(assignment)  calcRelationships(assignment)  # S4 method for Assignment calcRelationships(assignment)"},{"path":"https://aberhrml.github.io/assignments/reference/assignment-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Molecular formula assignment methods — calcCorrelations","text":"assignment object S4 class Assignment","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment-methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Molecular formula assignment methods — calcCorrelations","text":"object S4 class Assignment containing molecular formula assignments.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment-methods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Molecular formula assignment methods — calcCorrelations","text":"circumstances molecular formula assignment approach high memory requirements, many correlations (> 2 million) many high m/z (>700), may preferable perform assignment steps separately opposed using assignMFs(). can reduce memory overheads required successfully assign molecular formulas data also enable possibility objects saved /unloaded assignment steps needed.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment-methods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Molecular formula assignment methods — calcCorrelations","text":"","code":"plan(future::sequential) p <- assignmentParameters('FIE-HRMS')  mf_assignments <- assignment(feature_data,p)  mf_assignments <- mf_assignments %>%     calcCorrelations() %>%     calcRelationships() %>%     addIsoAssign() %>%     transformationAssign() #> Calculating correlations … #> Calculating correlations \t✔ [10 correlations] [0.5S] #> Calculating relationships … #> Calculating relationships \t✔ [3.7S] #> Adduct & isotopic assignment … #> generating molecular formulas… #> generating molecular formulas\t✔ [46.1S] #> iteration 1… #> iteration 1\t\t\t✔ [1.1S] #> iteration 2… #> Adduct & isotopic assignment \t✔ [49.1S] #> Transformation assignment… #> iteration 1 … #> iteration 1 \t\t\t✔ [2.7S] #> iteration 2 … #> Transformation assignment \t✔ [2.7S]  mf_assignments #>  #> assignments v1.0.0  #> Assignment:  #> \t Features:\t\t 10  #> \t Correlations:\t\t 10  #> \t Relationships:\t\t 52  #>  #> \t Adduct & isotope assignment:  #> \t\t Iterations:\t 1  #> \t\t MFs:\t\t 1  #> \t\t Assigned:\t 5  #>  #> \t Transformation assignment:  #> \t\t Iterations:\t 1  #> \t\t MFs:\t\t 1  #> \t\t Assigned:\t 1  #>  #> \t Total assignments:\t 6 (60%)  #> \t Unique MFs:\t\t 2  #>"},{"path":"https://aberhrml.github.io/assignments/reference/assignment.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an Assignment S4 class object — assignment","title":"Create an Assignment S4 class object — assignment","text":"Constructor methods creating object S4 class Assignment.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an Assignment S4 class object — assignment","text":"","code":"assignment(feature_data, parameters, ...)  # S4 method for tbl_df,AssignmentParameters assignment(feature_data, parameters)  # S4 method for AnalysisData,AssignmentParameters assignment(feature_data, parameters)  # S4 method for Analysis,AssignmentParameters assignment(feature_data, parameters, type = c(\"pre-treated\", \"raw\"))"},{"path":"https://aberhrml.github.io/assignments/reference/assignment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an Assignment S4 class object — assignment","text":"feature_data tibble object S4 class AnalysisData Analysis containing feature intensity matrix m/z assign molecular formulas. See details. parameters S4 object class AssignmentParamters containing parameters molecular formula assignment ... arguments pass relevant method type type pre-treated raw data perform assignment argument feature_data class Analysis","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an Assignment S4 class object — assignment","text":"object S4 class Assignment.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create an Assignment S4 class object — assignment","text":"","code":"mf_assignments <- assignment(feature_data,assignmentParameters('FIE-HRMS')) mf_assignments #>  #> assignments v1.0.0  #> Assignment:  #> \t Features:\t\t 10  #> \t Correlations:\t\t 0  #> \t Relationships:\t\t 0  #>"},{"path":"https://aberhrml.github.io/assignments/reference/assignmentParameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Assignment parameters — assignmentParameters","title":"Assignment parameters — assignmentParameters","text":"Return default molecular formula assignment parameters given analytical technique.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignmentParameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assignment parameters — assignmentParameters","text":"","code":"assignmentParameters(technique = availableTechniques())"},{"path":"https://aberhrml.github.io/assignments/reference/assignmentParameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assignment parameters — assignmentParameters","text":"technique technique use assignment","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignmentParameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assignment parameters — assignmentParameters","text":"object S4 class AssignmentParameters","code":""},{"path":"https://aberhrml.github.io/assignments/reference/assignmentParameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assignment parameters — assignmentParameters","text":"","code":"assignmentParameters('FIE-HRMS') #>  #> Assignment Parameters:  #>  #> \t Technique:\t\t FIE-HRMS  #> \t Max M:\t\t\t 800  #> \t MF rank threshold:\t 3  #> \t PPM threshold:\t\t 6  #> \t Relationship limit:\t 0.001  #> \t RT limit:\t\t   #> \t Correlations: #> \t\tmethod: spearman #>  \t\tpAdjustMethod: bonferroni #>  \t\tcorPvalue: 0.05 #>  \t\tminCoef: 0.7 #>  \t\tmaxCor: Inf #>  #> \t Adducts:  #> \t n: [M-H]1-, [M+Cl]1-, [M+K-2H]1-, [M-2H]2-, [M+Cl37]1-, [2M-H]1- #> \t p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+  #> \t Isotopes: 13C, 18O, 13C2  #> \t Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2]"},{"path":"https://aberhrml.github.io/assignments/reference/availableTechniques.html","id":null,"dir":"Reference","previous_headings":"","what":"Available analytical techniques — availableTechniques","title":"Available analytical techniques — availableTechniques","text":"available analytical techniques molecular formula assignment parameters.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/availableTechniques.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Available analytical techniques — availableTechniques","text":"","code":"availableTechniques()"},{"path":"https://aberhrml.github.io/assignments/reference/availableTechniques.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Available analytical techniques — availableTechniques","text":"character vector technique names.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/availableTechniques.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Available analytical techniques — availableTechniques","text":"","code":"availableTechniques() #> [1] \"FIE-HRMS\"   \"RP-LC-HRMS\" \"NP-LC-HRMS\""},{"path":"https://aberhrml.github.io/assignments/reference/feature_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Example feature data — feature_data","title":"Example feature data — feature_data","text":"example m/z peak intensity matrix containing total ion count normalised positive negative mode flow infusion electrospray ionisation mass spectrometry m/z features.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/feature_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example feature data — feature_data","text":"","code":"feature_data"},{"path":"https://aberhrml.github.io/assignments/reference/feature_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example feature data — feature_data","text":"tibble containing 60 rows 10 variables.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract graph attributes — nodes","title":"Extract graph attributes — nodes","text":"Extract node edge attributes tidygraph tbl_graph object.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract graph attributes — nodes","text":"","code":"nodes(graph)  edges(graph)"},{"path":"https://aberhrml.github.io/assignments/reference/graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract graph attributes — nodes","text":"graph object class tbl_graph","code":""},{"path":"https://aberhrml.github.io/assignments/reference/graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract graph attributes — nodes","text":"","code":"a_graph <- tidygraph::tbl_graph(   nodes = data.frame(     name = c('a','b','c')   ),    edges = data.frame(     from = c(1,2),     to = c(2,3),     type = c(1,2)   ))  ## Extract graph nodes nodes(a_graph) #> # A tibble: 3 × 1 #>   name  #>   <chr> #> 1 a     #> 2 b     #> 3 c      ## Extract graph edges edges(a_graph) #> # A tibble: 2 × 1 #>    type #>   <dbl> #> 1     1 #> 2     2"},{"path":"https://aberhrml.github.io/assignments/reference/parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameter get and set methods — technique","title":"Parameter get and set methods — technique","text":"Get set methods AssignmentParameters S4 class.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameter get and set methods — technique","text":"","code":"technique(x)  # S4 method for AssignmentParameters technique(x)  correlationsParameters(x)  # S4 method for AssignmentParameters correlationsParameters(x)  correlationsParameters(x) <- value  # S4 method for AssignmentParameters,list correlationsParameters(x) <- value  limit(x)  # S4 method for AssignmentParameters limit(x)  limit(x) <- value  # S4 method for AssignmentParameters limit(x) <- value  maxM(x)  # S4 method for AssignmentParameters maxM(x)  maxM(x) <- value  # S4 method for AssignmentParameters maxM(x) <- value  MFrankThreshold(x)  # S4 method for AssignmentParameters MFrankThreshold(x)  MFrankThreshold(x) <- value  # S4 method for AssignmentParameters MFrankThreshold(x) <- value  ppm(x)  # S4 method for AssignmentParameters ppm(x)  ppm(x) <- value  # S4 method for AssignmentParameters ppm(x) <- value  isotopes(x)  # S4 method for AssignmentParameters isotopes(x)  isotopes(x) <- value  # S4 method for AssignmentParameters isotopes(x) <- value  adducts(x)  # S4 method for AssignmentParameters adducts(x)  adducts(x) <- value  # S4 method for AssignmentParameters adducts(x) <- value  transformations(x)  # S4 method for AssignmentParameters transformations(x)  transformations(x) <- value  # S4 method for AssignmentParameters transformations(x) <- value  adductRules(x)  # S4 method for AssignmentParameters adductRules(x)  adductRules(x) <- value  # S4 method for AssignmentParameters adductRules(x) <- value  isotopeRules(x)  # S4 method for AssignmentParameters isotopeRules(x)  isotopeRules(x) <- value  # S4 method for AssignmentParameters isotopeRules(x) <- value  transformationRules(x)  # S4 method for AssignmentParameters transformationRules(x)  transformationRules(x) <- value  # S4 method for AssignmentParameters transformationRules(x) <- value"},{"path":"https://aberhrml.github.io/assignments/reference/parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameter get and set methods — technique","text":"x S4 object class AssignmentParameters value value set","code":""},{"path":"https://aberhrml.github.io/assignments/reference/parameters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parameter get and set methods — technique","text":"technique - Get analytical technique. correlationsParameters - Get set correlation analysis parameters passed metabolyseR::correlations(). limit - Get set atomic mass unit limit relationship calculation. maxM - Get set maximum molecular mass limit assign molecular formulas. MFrankThreshold - Get set molecular formula rank threshold molecular formula selection. ppm - Get set parts per million error threshold. isotopes - Get set isotope names. order specified denotes expected relative commonality within data set. adducts - Get set adduct names ionisation modes. order specified denotes expected relative commonality within data set ionisation mode. transformations - Get set transformation molecular formula changes. isotopeRules - Get set isotope rules table. format tibble match mzAnnotation::isotope_rules(). adductRules - Get set adduct rules table. format tibble match mzAnnotation::adduct_rules(). techniqueRules - Get set transformation rules table. format tibble match mzAnnotation::transformation_rules().","code":""},{"path":"https://aberhrml.github.io/assignments/reference/parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parameter get and set methods — technique","text":"","code":"assignment_parameters <- assignmentParameters('FIE')  ## Return the analytical technique technique(assignment_parameters) #> [1] \"FIE-HRMS\"  ## Return correlations parameters correlationsParameters(assignment_parameters) #> $method #> [1] \"spearman\" #>  #> $pAdjustMethod #> [1] \"bonferroni\" #>  #> $corPvalue #> [1] 0.05 #>  #> $minCoef #> [1] 0.7 #>  #> $maxCor #> [1] Inf #>   ## Set correlations parameters correlationsParameters(assignment_parameters)$minCoef <- 0.75  ## Return limit limit(assignment_parameters) #> [1] 0.001  ## Set limit limit(assignment_parameters) <- 0.002  ## Return max M maxM(assignment_parameters) #> [1] 800  ## Set max M maxM(assignment_parameters) <- 500  ## Return MF rank threshold MFrankThreshold(assignment_parameters) #> [1] 3  ## Set MF rank threshold MFrankThreshold(assignment_parameters) <- 3  ## Return ppm ppm(assignment_parameters) #> [1] 6  ## Set ppm ppm(assignment_parameters) <- 3  ## Return isotopes isotopes(assignment_parameters) #> [1] \"13C\"  \"18O\"  \"13C2\"  ## Set isotopes isotopes(assignment_parameters) <- '13C'  ## Return adducts adducts(assignment_parameters) #> $n #> [1] \"[M-H]1-\"    \"[M+Cl]1-\"   \"[M+K-2H]1-\" \"[M-2H]2-\"   \"[M+Cl37]1-\" #> [6] \"[2M-H]1-\"   #>  #> $p #> [1] \"[M+H]1+\"   \"[M+K]1+\"   \"[M+Na]1+\"  \"[M+K41]1+\" \"[M+2H]2+\"  \"[2M+H]1+\"  #>   ## Set adducts adducts(assignment_parameters) <- list(n = c('[M-H]1-','[M+Cl]1-'),                                    p = c('[M+H]1+','[M+K]1+'))                                     ## Return transformations transformations(assignment_parameters) #>  [1] \"M - [O] + [NH2]\"   \"M - [OH] + [NH2]\"  \"M + [H2]\"          #>  [4] \"M - [H2] + [O]\"    \"M - [H] + [CH3]\"   \"M - [H] + [NH2]\"   #>  [7] \"M - [H] + [OH]\"    \"M + [H2O]\"         \"M - [H3] + [H2O]\"  #> [10] \"M - [H] + [CHO2]\"  \"M - [H] + [SO3]\"   \"M - [H] + [PO3H2]\"  ## Set transformations transformations(assignment_parameters) <- \"M - [O] + [NH2]\"  ## Return adduct rules adductRules(assignment_parameters) #> # A tibble: 58 × 12 #>    Name   Charge    xM   Add Nelec AddAt RemAt AddEx RemEx Rule  Default Isoto…¹ #>    <chr>   <int> <int> <dbl> <int> <chr> <chr> <chr> <chr> <chr>   <int>   <dbl> #>  1 [M+3N…      3     1 23.0     -3 NA    NA    Na3   NA    HBA2…       0       0 #>  2 [M+H+…      3     1 15.7     -3 NA    NA    Na2H  NA    HBA2…       0       0 #>  3 [M+2H…      3     1  8.33    -3 NA    NA    NaH2  NA    HBA2…       0       0 #>  4 [M+3H…      3     1  1.01    -3 NA    NA    H3    NA    HBA2…       0       0 #>  5 [2M+3…      2     2 28.0     -2 NA    NA    H8O3  NA    HBA2…       0       0 #>  6 [M+3A…      2     1 62.5     -2 NA    NA    C6H1… NA    HBA2…       0       0 #>  7 [M+2A…      2     1 42.0     -2 NA    NA    C4H8… NA    HBA2…       0       0 #>  8 [M+2N…      2     1 23.0     -2 NA    NA    Na2   NA    HBA2…       1       0 #>  9 [M+AC…      2     1 21.5     -2 NA    NA    C2H5N NA    HBA2…       0       0 #> 10 [M+H+…      2     1 20.0     -2 NA    NA    KH    NA    HBA2…       1       0 #> # … with 48 more rows, and abbreviated variable name ¹​Isotopic  ## Set adduct rules adductRules(assignment_parameters) <- mzAnnotation::adduct_rules()  ## Return isotope rules isotopeRules(assignment_parameters) #> # A tibble: 8 × 4 #>   Isotope `Mass Difference` Rule  Default #>   <chr>               <dbl> <chr>   <int> #> 1 13C                  1.00 C>0         1 #> 2 13C2                 2.01 C>1         1 #> 3 13C3                 3.01 C>2         0 #> 4 13C4                 4.01 C>3         0 #> 5 18O                  2.00 O>0         1 #> 6 37Cl                 2.00 Cl>0        0 #> 7 41K                  2.00 K>0         0 #> 8 34S                  2.00 S>0         1  ## Set isotope rules isotopeRules(assignment_parameters) <- mzAnnotation::isotope_rules()  ## Return transformation rules transformationRules(assignment_parameters) #> # A tibble: 12 × 10 #>    Name              MF Ch…¹ Diffe…²     C     H     N     O     P     S Default #>    <chr>             <chr>     <dbl> <int> <int> <int> <int> <int> <int>   <int> #>  1 Transamination 1  M - [O…  0.0238     0     2     1    -1     0     0       1 #>  2 Ammonia ligation  M - [O… -0.984      0     1     1    -1     0     0       1 #>  3 Hydrogenation     M + [H…  2.02       0     2     0     0     0     0       1 #>  4 Alcohol to carbo… M - [H… 14.0        0    -2     0     1     0     0       1 #>  5 Methylation       M - [H… 14.0        1     2     0     0     0     0       1 #>  6 Transamination 2  M - [H… 15.0        0     1     1     0     0     0       1 #>  7 Hydroxylation     M - [H… 16.0        0     0     0     1     0     0       1 #>  8 Hydration         M + [H… 18.0        0     2     0     1     0     0       1 #>  9 Methyl to carbox… M - [H… 30.0        0    -1     0     1     0     0       1 #> 10 Carboxylation     M - [H… 44.0        1     0     0     2     0     0       1 #> 11 Sulphation        M - [H… 80.0        0    -1     0     3     0     1       1 #> 12 Phosphorylation   M - [H… 80.0        0     1     0     3     1     0       1 #> # … with abbreviated variable names ¹​`MF Change`, ²​Difference  ## Set transformation rules transformationRules(assignment_parameters) <- mzAnnotation::transformation_rules()"},{"path":"https://aberhrml.github.io/assignments/reference/plotting.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot assignment results — plotAdductDist","title":"Plot assignment results — plotAdductDist","text":"Plot molecular formula assignment results.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/plotting.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot assignment results — plotAdductDist","text":"","code":"plotAdductDist(assignment)  # S4 method for Assignment plotAdductDist(assignment)  plotComponent(   assignment,   component,   iteration,   type = c(\"selected\", \"all\"),   label_size = 3,   axis_offset = 0.1,   border = NA,   highlight = NA )  # S4 method for Assignment plotComponent(   assignment,   component,   iteration,   type = c(\"selected\", \"all\"),   label_size = 3,   axis_offset = 0.1,   border = NA,   highlight = NA )  plotFeatureComponents(   assignment,   feature,   iteration,   type = c(\"all\", \"selected\"),   max_components = 6,   label_size = 3,   axis_offset = 0.1 )  # S4 method for Assignment plotFeatureComponents(   assignment,   feature,   iteration,   type = c(\"all\", \"selected\"),   max_components = 6,   label_size = 2,   axis_offset = 0.05 )  plotSpectrum(assignment, MF)  # S4 method for Assignment plotSpectrum(assignment, MF)"},{"path":"https://aberhrml.github.io/assignments/reference/plotting.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot assignment results — plotAdductDist","text":"assignment object S4 class Assignment component component number plot iteration assignment iteration component components type graph type return. selected returns assignment graph component selection. returns assignment components. label_size node label size axis_offset axis proportion increase axis limits. Prevents cut node labels. border specify plot border colour highlight specify feature node highlight feature m/z feature plot max_components themaximum number components plot MF assigned molecular formula plot","code":""},{"path":"https://aberhrml.github.io/assignments/reference/plotting.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot assignment results — plotAdductDist","text":"plotComponent - Plot molecular formula component graph. plotFeatureComponents - Plot possible component graphs given feature. plotAdductDist - Plot frequency distributions assigned adducts. plotSpectrum - Plot spectrum assigned molecular formula.","code":""},{"path":"https://aberhrml.github.io/assignments/reference/plotting.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot assignment results — plotAdductDist","text":"","code":"library(ggraph) #> Loading required package: ggplot2 plan(future::sequential) p <- assignmentParameters('FIE-HRMS')  mf_assignments <- assignMFs(feature_data,p) #>  #> assignments v1.0.0 Tue Feb 21 16:06:03 2023 #> ________________________________________________________________________________ #> Assignment Parameters:  #>  #> \t Technique:\t\t FIE-HRMS  #> \t Max M:\t\t\t 800  #> \t MF rank threshold:\t 3  #> \t PPM threshold:\t\t 6  #> \t Relationship limit:\t 0.001  #> \t RT limit:\t\t   #> \t Correlations: #> \t\tmethod: spearman #>  \t\tpAdjustMethod: bonferroni #>  \t\tcorPvalue: 0.05 #>  \t\tminCoef: 0.7 #>  \t\tmaxCor: Inf #>  #> \t Adducts:  #> \t n: [M-H]1-, [M+Cl]1-, [M+K-2H]1-, [M-2H]2-, [M+Cl37]1-, [2M-H]1- #> \t p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+  #> \t Isotopes: 13C, 18O, 13C2  #> \t Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2] #> ________________________________________________________________________________ #> No. m/z:\t10 #> Calculating correlations … #> Calculating correlations \t✔ [10 correlations] [0.5S] #> Calculating relationships … #> Calculating relationships \t✔ [4.3S] #> Adduct & isotopic assignment … #> generating molecular formulas… #> generating molecular formulas\t✔ [45.4S] #> iteration 1… #> iteration 1\t\t\t✔ [1.1S] #> iteration 2… #> Adduct & isotopic assignment \t✔ [48.4S] #> Transformation assignment… #> iteration 1 … #> iteration 1 \t\t\t✔ [2.6S] #> iteration 2 … #> Transformation assignment \t✔ [2.7S] #> ________________________________________________________________________________ #>  #> Complete! [56.8S]  ## Plot a component plotComponent(mf_assignments,1,'A&I1')   ## Plot the components for a feature plotFeatureComponents(mf_assignments,'n191.01962','A&I1')   ## Plot the adduct distributions plotAdductDist(mf_assignments)   ## Plot the spectrum of an assigned molecular formula plotSpectrum(mf_assignments,'C6H8O7')"},{"path":"https://aberhrml.github.io/assignments/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. future plan magrittr %>%","code":""},{"path":"https://aberhrml.github.io/assignments/news/index.html","id":"assignments-100","dir":"Changelog","previous_headings":"","what":"assignments 1.0.0","title":"assignments 1.0.0","text":"Added NEWS.md file track changes package. Assignment S4 class now inherits AssignmentParameters S4 class. molecular formula generation now handled mzAnnotation::ipMF(). Improved molecular formula selection routine based Seven Golden Rules Kind et al. 2007. adduct isotope assignment routine now conducted multiple iterations. Graphical components now selected using improved plausibility score. Graphical components now retained contain least one non-isotopic assignment. individual assignment step methods (calcCorrelations(), calcRelationships(), addIsoAssign(), transformAssign()) now exported. Added availableTechniques() function return supported analytical techniques. Numerous documentation improvements. Added usage introduction vignette. package documentation now available https://aberhrml.github.io/assignments/","code":""}]
