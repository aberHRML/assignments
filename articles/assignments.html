<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="assignments">
<title>assignments • assignments</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="assignments">
<meta property="og:description" content="assignments">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">assignments</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/assignments.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>assignments</h1>
            
      
      
      <div class="d-none name"><code>assignments.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>assignments</em> package provides an automated molecular
formula assignment approach for ultra-high resolution electrospray
ionisation mass spectrometry (ESI-MS) data from metabolomics
experiments. This includes data from both direct and flow
injection/infusion fingerprinting as well as liquid chromatograph mass
spectrometry (LC-MS) profiling analytical techniques.</p>
<p>This vignette will provide a brief overview of the input data
required, parameter selection, performing the assignments and assessing
the results.</p>
<p>Before we begin, first load the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aberhrml.github.io/assignments/">assignments</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="computational-requirements-and-parallel-processing">Computational requirements and parallel processing<a class="anchor" aria-label="anchor" href="#computational-requirements-and-parallel-processing"></a>
</h2>
<p>This approach is computationally intensive so the use of
high-performance computing resources is recommended. A suggested minimum
would be the use of 16 CPU workers and at least 8GB of RAM per worker
(128GB total) to ensure that processing is completed in a reasonable
duration.</p>
<p>The parallel back-end is provided by the <a href="https://future.futureverse.org/" class="external-link"><em>future</em></a> package.
Information about the available parallel strategies can be found <a href="https://future.futureverse.org/#controlling-how-futures-are-resolved" class="external-link">here</a>.
This example will use a relatively tiny data set so the following
example parallel options will be used:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">'multisession'</span>,workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The requirements for data input are designed to be as simple as
possible. Input data should consist of an <em>m/z</em> by sample
intensity matrix with positive an negative mode data combined where
available. The <em>m/z</em> features provided as column names should be
in the form of
<code>&lt;ionisation_mode&gt;&lt;m/z&gt;@&lt;retention_time&gt;</code>.
Ionisation mode should be given as a prefix <code>n</code> or
<code>p</code> for negative or positive ionisation modes respectively.
Feature <em>m/z</em> should be provided to an accuracy of least 5
decimal places. The retention time portion
(<code>@&lt;retention_time&gt;</code>) is only required for LC-MS data
and should be provided in minutes.</p>
<p>It is recommended that the data undergo pre-treatment routines such
as relative standard deviation filtering, imputation and/or
normalisation prior to assignment. However, this is not essential
requirement and raw intensity values could also be used.</p>
<p>The input data for this example is a subset from an FIE-HRMS
metabolomics experiment and is shown below. The feature intensities are
total ion count (TIC) normalised.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 60 × 10</span></span></span>
<span><span class="co">#&gt;    n191.01962 n192.02306 n193.02388 n226.99693 n228.97636 n228.99274 n231.00069</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0.109     0.004<span style="text-decoration: underline;">01</span>   0.000<span style="text-decoration: underline;">609</span>   0.000<span style="text-decoration: underline;">417</span>   0.001<span style="text-decoration: underline;">35</span>   0.000<span style="text-decoration: underline;">091</span>2   0.001<span style="text-decoration: underline;">22</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     0.095<span style="text-decoration: underline;">5</span>    0.003<span style="text-decoration: underline;">46</span>   0.000<span style="text-decoration: underline;">466</span>   0.000<span style="text-decoration: underline;">306</span>   0.001<span style="text-decoration: underline;">10</span>   0.000<span style="text-decoration: underline;">084</span>7   0.000<span style="text-decoration: underline;">831</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     0.109     0.004<span style="text-decoration: underline;">18</span>   0.000<span style="text-decoration: underline;">637</span>   0.000<span style="text-decoration: underline;">294</span>   0.001<span style="text-decoration: underline;">13</span>   0.000<span style="text-decoration: underline;">087</span>9   0.001<span style="text-decoration: underline;">26</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     0.102     0.003<span style="text-decoration: underline;">60</span>   0.000<span style="text-decoration: underline;">516</span>   0.000<span style="text-decoration: underline;">366</span>   0.001<span style="text-decoration: underline;">07</span>   0.000<span style="text-decoration: underline;">107</span>    0.001<span style="text-decoration: underline;">13</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     0.095<span style="text-decoration: underline;">6</span>    0.003<span style="text-decoration: underline;">15</span>   0.000<span style="text-decoration: underline;">520</span>   0.000<span style="text-decoration: underline;">487</span>   0.000<span style="text-decoration: underline;">873</span>  0.000<span style="text-decoration: underline;">111</span>    0.000<span style="text-decoration: underline;">840</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     0.094<span style="text-decoration: underline;">0</span>    0.003<span style="text-decoration: underline;">50</span>   0.000<span style="text-decoration: underline;">440</span>   0.000<span style="text-decoration: underline;">311</span>   0.001<span style="text-decoration: underline;">12</span>   0.000<span style="text-decoration: underline;">022</span>8   0.001<span style="text-decoration: underline;">06</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     0.128     0.005<span style="text-decoration: underline;">78</span>   0.000<span style="text-decoration: underline;">784</span>   0.000<span style="text-decoration: underline;">333</span>   0.001<span style="text-decoration: underline;">13</span>   0.000<span style="text-decoration: underline;">137</span>    0.001<span style="text-decoration: underline;">40</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     0.089<span style="text-decoration: underline;">0</span>    0.003<span style="text-decoration: underline;">45</span>   0.000<span style="text-decoration: underline;">483</span>   0.000<span style="text-decoration: underline;">365</span>   0.001<span style="text-decoration: underline;">04</span>   0.000<span style="text-decoration: underline;">100</span>    0.000<span style="text-decoration: underline;">951</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     0.088<span style="text-decoration: underline;">7</span>    0.003<span style="text-decoration: underline;">17</span>   0.000<span style="text-decoration: underline;">469</span>   0.000<span style="text-decoration: underline;">463</span>   0.000<span style="text-decoration: underline;">829</span>  0.000<span style="text-decoration: underline;">151</span>    0.000<span style="text-decoration: underline;">922</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     0.099<span style="text-decoration: underline;">6</span>    0.003<span style="text-decoration: underline;">69</span>   0.000<span style="text-decoration: underline;">539</span>   0.000<span style="text-decoration: underline;">490</span>   0.000<span style="text-decoration: underline;">866</span>  0.000<span style="text-decoration: underline;">193</span>    0.001<span style="text-decoration: underline;">00</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: n384.0495 &lt;dbl&gt;, n385.04874 &lt;dbl&gt;, p208.04518 &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
<p>Default parameters for a number of techniques are provided. The
available techniques can be viewed as shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/availableTechniques.html">availableTechniques</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "FIE-HRMS"   "RP-LC-HRMS" "NP-LC-HRMS"</span></span></code></pre></div>
<p>The <code>FIE-HRMS</code> fingerprinting technique parameters would
also be suitable for direct injection data. The default parameters are
designed to be as widely applicable as possible and should suit many
situations. For this example we will specify the use of the
<code>FIE-HRMS</code> parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assignmentParameters.html">assignmentParameters</a></span><span class="op">(</span><span class="st">'FIE-HRMS'</span><span class="op">)</span></span></code></pre></div>
<p>The parameters can then be viewed by printing the returned
object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #BBBB00;">#&gt; Assignment Parameters:</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Technique:      FIE-HRMS </span></span>
<span><span class="co">#&gt;   Max M:          800 </span></span>
<span><span class="co">#&gt;   MF rank threshold:  3 </span></span>
<span><span class="co">#&gt;   PPM threshold:      4 </span></span>
<span><span class="co">#&gt;   Relationship limit:     0.001 </span></span>
<span><span class="co">#&gt;   RT limit:        </span></span>
<span><span class="co">#&gt;   Correlations:</span></span>
<span><span class="co">#&gt;      method: spearman</span></span>
<span><span class="co">#&gt;          pAdjustMethod: bonferroni</span></span>
<span><span class="co">#&gt;          corPvalue: 0.05</span></span>
<span><span class="co">#&gt;          minCoef: 0.7</span></span>
<span><span class="co">#&gt;          maxCor: Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Adducts: </span></span>
<span><span class="co">#&gt;   n: [M-H]1-, [M+Cl]1-, [M+Cl37]1-, [M+K-2H]1-, [M-2H]2-, [2M-H]1-</span></span>
<span><span class="co">#&gt;   p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+ </span></span>
<span><span class="co">#&gt;   Isotopes: 13C, 18O </span></span>
<span><span class="co">#&gt;   Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2]</span></span></code></pre></div>
<p>It is possible to access and set all of these parameters. For
example, the <code>adducts</code> method can be used to access the
specified adducts:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/parameters.html">adducts</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] "[M-H]1-"    "[M+Cl]1-"   "[M+Cl37]1-" "[M+K-2H]1-" "[M-2H]2-"  </span></span>
<span><span class="co">#&gt; [6] "[2M-H]1-"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p</span></span>
<span><span class="co">#&gt; [1] "[M+H]1+"   "[M+K]1+"   "[M+Na]1+"  "[M+K41]1+" "[M+2H]2+"  "[2M+H]1+"</span></span></code></pre></div>
<p>More accessor methods for assignment parameters can be viewed by
running <code>?parameters</code>.</p>
<p>Additional adducts, isotopes and transformations rules can also be
appended to the relevant rules tables within the assignment parameters
object. See the assignment parameters documentation for more
information.</p>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>To perform the molecular formula assignment we can execute the
following.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>assignment <span class="ot">&lt;-</span> <span class="fu">assignMFs</span>(feature_data,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                        parameters)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [34m</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; assignments  [39m [31mv1.0.2 [39m Thu Jan 11 15:07:54 2024</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [33mAssignment Parameters: [33m  [39m</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Technique:      FIE-HRMS </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Max M:          800 </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   MF rank threshold:  3 </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   PPM threshold:      4 </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Relationship limit:     0.001 </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   RT limit:        </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Correlations:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      method: spearman</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          pAdjustMethod: bonferroni</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          corPvalue: 0.05</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          minCoef: 0.7</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          maxCor: Inf</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Adducts: </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   n: [M-H]1-, [M+Cl]1-, [M+Cl37]1-, [M+K-2H]1-, [M-2H]2-, [2M-H]1-</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   p: [M+H]1+, [M+K]1+, [M+Na]1+, [M+K41]1+, [M+2H]2+, [2M+H]1+ </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Isotopes: 13C, 18O </span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Transformations: M - [O] + [NH2], M - [OH] + [NH2], M + [H2], M - [H2] + [O], M - [H] + [CH3], M - [H] + [NH2], M - [H] + [OH], M + [H2O], M - [H3] + [H2O], M - [H] + [CHO2], M - [H] + [SO3], M - [H] + [PO3H2]</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; No. m/z: 10</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [34mCalculating correlations  [39m…</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a> [34mCalculating correlations  [39m  [32m✔ [39m [<span class="dv">10</span> correlations] [<span class="fl">0.2</span>S]</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [34mCalculating relationships  [39m…</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a> [34mCalculating relationships  [39m     [32m✔ [39m [<span class="fl">7.5</span>S]</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [34mAdduct &amp; isotopic assignment  [39m…</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; generating molecular formulas…</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>generating molecular formulas    [32m✔ [39m [<span class="fl">6.3</span>S]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iteration 1…</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>iteration <span class="dv">1</span>          [32m✔ [39m [<span class="fl">5.5</span>S]</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iteration 2…</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a> [34mAdduct <span class="sc">&amp;</span> isotopic assignment  [39m  [32m✔ [39m [<span class="fl">16.9</span>S]</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [34mTransformation assignment [39m…</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iteration 1 …</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>iteration <span class="dv">1</span>              [32m✔ [39m [<span class="fl">8.5</span>S]</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iteration 2 …</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a> [34mTransformation assignment  [39m     [32m✔ [39m [<span class="fl">8.5</span>S]</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [32mComplete!  [39m[33.4S]</span></span></code></pre></div>
<p>For an overview of the assignment results, we can print the
object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assignment</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt; assignments</span> <span style="color: #BB0000;">v1.0.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">Assignment:</span> </span></span>
<span><span class="co">#&gt;   Features:       10 </span></span>
<span><span class="co">#&gt;   Correlations:       10 </span></span>
<span><span class="co">#&gt;   Relationships:      35 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   <span style="color: #00BB00;">Adduct &amp; isotope assignment:</span> </span></span>
<span><span class="co">#&gt;       Iterations:     1 </span></span>
<span><span class="co">#&gt;       MFs:        1 </span></span>
<span><span class="co">#&gt;       Assigned:   5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   <span style="color: #00BB00;">Transformation assignment:</span> </span></span>
<span><span class="co">#&gt;       Iterations:     1 </span></span>
<span><span class="co">#&gt;       MFs:        1 </span></span>
<span><span class="co">#&gt;       Assigned:   1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Total assignments:  <span style="color: #0000BB;">6</span> <span style="color: #0000BB;">(60%)</span> </span></span>
<span><span class="co">#&gt;   Unique MFs:         <span style="color: #0000BB;">2</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>The following can be used to access the assigned <em>m/z</em> feature
information.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">assignments</a></span><span class="op">(</span><span class="va">assignment</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 15</span></span></span>
<span><span class="co">#&gt;   Name   Feature RetentionTime Isotope Adduct MF    `Theoretical M` `Measured M`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> n191.… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> n192.… n192.0…            <span style="color: #BB0000;">NA</span> 13C     [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> n193.… n193.0…            <span style="color: #BB0000;">NA</span> 18O     [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> n226.… n226.9…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> n228.… n228.9…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> p208.… p208.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+H]… C6H9…            207.         207.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: `Theoretical m/z` &lt;dbl&gt;, `Measured m/z` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `PPM error` &lt;dbl&gt;, `MF Plausibility (%)` &lt;dbl&gt;, Mode &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Component &lt;dbl&gt;, Iteration &lt;chr&gt;</span></span></span></code></pre></div>
<p>These feature assignments can also be summarised for each molecular
formula.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">summariseAssignments</a></span><span class="op">(</span><span class="va">assignment</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   MF      Features                                  Isotopes &amp; Ionisatio…¹ Count</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> C6H8O7  n191.01962; n192.02306; n193.02388; n226… <span style="color: #949494;">"</span> [M-H]1-; 13C [M-H]1…     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C6H9NO7 p208.04518                                <span style="color: #949494;">"</span> [M+H]1+<span style="color: #949494;">"</span>                 1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Isotopes &amp; Ionisation Products`</span></span></span></code></pre></div>
<p>We can extract all the calculated correlations between the
<em>m/z</em> features.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">correlations</a></span><span class="op">(</span><span class="va">assignment</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 12</span></span></span>
<span><span class="co">#&gt;    Feature1   Feature2   Mode1 Mode2 `m/z1` `m/z2` RetentionTime1 RetentionTime2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> n191.01962 n192.02306 n     n       191.   192.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> n192.02306 p208.04518 n     p       192.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> n231.00069 n384.0495  n     n       231.   384.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> n226.99693 n228.99274 n     n       227.   229.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> n191.01962 n193.02388 n     n       191.   193.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> n193.02388 p208.04518 n     p       193.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> n192.02306 n193.02388 n     n       192.   193.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> n191.01962 n231.00069 n     n       191.   231.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> n231.00069 p208.04518 n     p       231.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: RetentionTimeDiff &lt;dbl&gt;, log2IntensityRatio &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   coefficient &lt;dbl&gt;, ID &lt;int&gt;</span></span></span></code></pre></div>
<p>As well as all the computed mathematical adduct, isotope and
transformation relationships.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">relationships</a></span><span class="op">(</span><span class="va">assignment</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 35 × 19</span></span></span>
<span><span class="co">#&gt;    Feature1   Feature2   Mode1 Mode2 `m/z1` `m/z2` RetentionTime1 RetentionTime2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> n191.01962 p208.04518 n     p       191.   208.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> n191.01962 n192.02306 n     n       191.   192.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> n191.01962 n192.02306 n     n       191.   192.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> n191.01962 n192.02306 n     n       191.   192.             <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 25 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more variables: RetentionTimeDiff &lt;dbl&gt;, Adduct1 &lt;chr&gt;, Adduct2 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Isotope1 &lt;chr&gt;, Isotope2 &lt;chr&gt;, Transformation1 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Transformation2 &lt;chr&gt;, log2IntensityRatio &lt;dbl&gt;, coefficient &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Error &lt;dbl&gt;, ID &lt;int&gt;</span></span></span></code></pre></div>
<p>To view all the iterations conducted during the assignment, the
following can be used.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">iterations</a></span><span class="op">(</span><span class="va">assignment</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A&amp;I1" "T1"</span></span></code></pre></div>
<p>Information for the component subgraphs identified in an iteration
can also be extracted. These can either be the <code>selected</code>
components or <code>all</code> the possible components.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">components</a></span><span class="op">(</span><span class="va">assignment</span>,</span>
<span>           iteration <span class="op">=</span> <span class="st">'A&amp;I1'</span>,</span>
<span>           type <span class="op">=</span> <span class="st">'selected'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   Component  Size Nodes Degree Density `Component Plausibility`</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1     3     3      2       1                0.001<span style="text-decoration: underline;">07</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>        11     1     2      1       1                0.000<span style="text-decoration: underline;">098</span>1</span></span></code></pre></div>
<p>We can extract the <a href="https://tidygraph.data-imaginist.com/" class="external-link"><em>tidygraph</em></a>
<code>tbl_graph</code> object for a given iterations.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">graph</a></span><span class="op">(</span><span class="va">assignment</span>,</span>
<span>      iteration <span class="op">=</span> <span class="st">'A&amp;I1'</span>,</span>
<span>      type <span class="op">=</span> <span class="st">'selected'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tbl_graph: 5 nodes and 4 edges</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # A directed acyclic simple graph with 2 components</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # Node Data: 5 × 21 (active)</span></span></span>
<span><span class="co">#&gt;   name   Feature RetentionTime Isotope Adduct MF    `Theoretical M` `Measured M`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> n191.… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> n192.… n192.0…            <span style="color: #BB0000;">NA</span> 13C     [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> n193.… n193.0…            <span style="color: #BB0000;">NA</span> 18O     [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> n226.… n226.9…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> n228.… n228.9…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: `Theoretical m/z` &lt;dbl&gt;, `Measured m/z` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `PPM error` &lt;dbl&gt;, `MF Plausibility (%)` &lt;dbl&gt;, AIS &lt;dbl&gt;, ID &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Component &lt;dbl&gt;, Size &lt;dbl&gt;, Nodes &lt;int&gt;, Degree &lt;dbl&gt;, Density &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Component Plausibility` &lt;dbl&gt;, Weight &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # Edge Data: 4 × 23</span></span></span>
<span><span class="co">#&gt;    from    to Feature1   Feature2   Mode1 Mode2 `m/z1` `m/z2` RetentionTime1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     2 n191.01962 n192.02306 n     n       191.   192.             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     3 n191.01962 n193.02388 n     n       191.   193.             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     2     3 n192.02306 n193.02388 n     n       192.   193.             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more row</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more variables: RetentionTime2 &lt;dbl&gt;, RetentionTimeDiff &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Adduct1 &lt;chr&gt;, Adduct2 &lt;chr&gt;, Isotope1 &lt;chr&gt;, Isotope2 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Transformation1 &lt;chr&gt;, Transformation2 &lt;chr&gt;, log2IntensityRatio &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   coefficient &lt;dbl&gt;, Error &lt;dbl&gt;, ID &lt;int&gt;, MF1 &lt;chr&gt;, MF2 &lt;chr&gt;</span></span></span></code></pre></div>
<p>Along with the graph of individual component.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">component</a></span><span class="op">(</span><span class="va">assignment</span>,</span>
<span>          component <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          iteration <span class="op">=</span> <span class="st">'A&amp;I1'</span>,</span>
<span>          type <span class="op">=</span> <span class="st">'selected'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tbl_graph: 3 nodes and 3 edges</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # A directed acyclic simple graph with 1 component</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # Node Data: 3 × 21 (active)</span></span></span>
<span><span class="co">#&gt;   name   Feature RetentionTime Isotope Adduct MF    `Theoretical M` `Measured M`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> n191.… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> n192.… n192.0…            <span style="color: #BB0000;">NA</span> 13C     [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> n193.… n193.0…            <span style="color: #BB0000;">NA</span> 18O     [M-H]… C6H8…            192.         192.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: `Theoretical m/z` &lt;dbl&gt;, `Measured m/z` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `PPM error` &lt;dbl&gt;, `MF Plausibility (%)` &lt;dbl&gt;, AIS &lt;dbl&gt;, ID &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Component &lt;dbl&gt;, Size &lt;dbl&gt;, Nodes &lt;int&gt;, Degree &lt;dbl&gt;, Density &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Component Plausibility` &lt;dbl&gt;, Weight &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # Edge Data: 3 × 23</span></span></span>
<span><span class="co">#&gt;    from    to Feature1   Feature2   Mode1 Mode2 `m/z1` `m/z2` RetentionTime1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     2 n191.01962 n192.02306 n     n       191.   192.             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     3 n191.01962 n193.02388 n     n       191.   193.             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     2     3 n192.02306 n193.02388 n     n       192.   193.             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more variables: RetentionTime2 &lt;dbl&gt;, RetentionTimeDiff &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Adduct1 &lt;chr&gt;, Adduct2 &lt;chr&gt;, Isotope1 &lt;chr&gt;, Isotope2 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Transformation1 &lt;chr&gt;, Transformation2 &lt;chr&gt;, log2IntensityRatio &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   coefficient &lt;dbl&gt;, Error &lt;dbl&gt;, ID &lt;int&gt;, MF1 &lt;chr&gt;, MF2 &lt;chr&gt;</span></span></span></code></pre></div>
<p>And all the components of a given feature.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accessors.html">featureComponents</a></span><span class="op">(</span><span class="va">assignment</span>,</span>
<span>                  feature <span class="op">=</span> <span class="st">'n191.01962'</span>,</span>
<span>                  type <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 22</span></span></span>
<span><span class="co">#&gt;    Iteration name     Feature RetentionTime Isotope Adduct MF    `Theoretical M`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… C6H8…           192. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… CH5N…           192. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… C5H1…           192. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… C2H1…           156. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… C3H1…           156. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+K-… C4H1…           154. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+K-… C2H2…           154. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [2M-H… CH8N…            96.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A&amp;I1      n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M+Cl… CH8N…           156. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> T1        n191.01… n191.0…            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      [M-H]… C6H8…           192. </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more variables: `Measured M` &lt;dbl&gt;, `Theoretical m/z` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Measured m/z` &lt;dbl&gt;, `PPM error` &lt;dbl&gt;, `MF Plausibility (%)` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AIS &lt;dbl&gt;, ID &lt;int&gt;, Component &lt;dbl&gt;, Weight &lt;dbl&gt;, Size &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Nodes &lt;int&gt;, Degree &lt;dbl&gt;, Density &lt;dbl&gt;, `Component Plausibility` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The graph of an individual component can be visualised. This first
requires the <em>ggraph</em> package to be loaded.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotting.html">plotComponent</a></span><span class="op">(</span><span class="va">assignment</span>,</span>
<span>              component <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              iteration <span class="op">=</span> <span class="st">'A&amp;I1'</span>,</span>
<span>              type <span class="op">=</span> <span class="st">'selected'</span><span class="op">)</span></span></code></pre></div>
<p><img src="assignments_files/figure-html/plot-component-1.png" width="384" style="display: block; margin: auto;"></p>
<p>We can also visualise the components containing a specific feature
for a given iteration.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotting.html">plotFeatureComponents</a></span><span class="op">(</span></span>
<span>  <span class="va">assignment</span>,</span>
<span>  feature <span class="op">=</span> <span class="st">'n191.01962'</span>,</span>
<span>  iteration <span class="op">=</span> <span class="st">'A&amp;I1'</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'all'</span>,</span>
<span>  max_components <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  axis_offset <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="assignments_files/figure-html/feature-solutions-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Because a molecular formula ranking threshold is applied during
assignment, it may also be useful to generate all the alternative
molecular formulas and their rankings for a specific <em>m/z</em>,
adduct and isotope using the <code>ipMF</code> function from the <a href="https://aberhrml.github.io/mzAnnotation/" class="external-link"><em>mzAnnotation</em></a>
package.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mzAnnotation</span><span class="fu">::</span><span class="fu"><a href="http://aberhrml.github.io/mzAnnotation/reference/ipMF.html" class="external-link">ipMF</a></span><span class="op">(</span><span class="fl">191.01962</span>,</span>
<span>     adduct <span class="op">=</span> <span class="st">'[M-H]1-'</span>,</span>
<span>     isotope <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>     ppm <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 9</span></span></span>
<span><span class="co">#&gt;    MF         Adduct  Isotope `Measured m/z` `Measured M` `Theoretical m/z`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> C6H8O7     [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> C7H12O2S2  [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> C10H10P2   [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> CH5N8O2P   [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> C5H10N3OS2 [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> H9N4O6P    [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> C6H13NP3   [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H19O3P3S   [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> C2H16N2P4  [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> C2H11NO7P  [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> C5H2N7O2   [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> CH13N4OPS2 [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> CH21PS4    [M-H]1- <span style="color: #BB0000;">NA</span>                191.         192.              191.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: `Theoretical M` &lt;dbl&gt;, `PPM error` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Plausibility (%)` &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jasen Finch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
